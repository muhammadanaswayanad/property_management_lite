<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- Invoice Email Template -->
    <record id="email_template_property_invoice" model="mail.template">
        <field name="name">Property Invoice - Send by Email</field>
        <field name="model_id" ref="model_account_move"/>
        <field name="subject">Invoice ${object.name} for ${object.room_id.name} - ${object.property_id.name}</field>
        <field name="email_from">${object.company_id.email}</field>
        <field name="partner_to">${object.tenant_id.id}</field>
        <field name="body_html" type="html">
            <span>
                <p>
                    Dear <strong><span t-field="object.tenant_id.name"/></strong>,
                    <hr class="mb-1 mt-1"/>
                    Please find attached your invoice <strong><span t-field="object.name"/></strong> for 
                    <strong><span t-field="object.room_id.name"/></strong> at <strong><span t-field="object.property_id.name"/></strong>.
                    <br/><br/>
                    <strong>Invoice Details:</strong><br/>
                    - Invoice Date: <span t-field="object.invoice_date"/><br/>
                    - Due Date: <span t-field="object.invoice_date_due"/><br/>
                    - Amount: <span t-field="object.amount_total"/> <span t-field="object.currency_id.symbol"/><br/>
                    <t t-if="object.period_from and object.period_to">
                        - Period: <span t-field="object.period_from"/> to <span t-field="object.period_to"/><br/>
                    </t>
                    <br/>
                    <t t-if="object.amount_residual &gt; 0">
                        <p style="color: #d9534f;">
                            <strong>Amount Due: <span t-field="object.amount_residual"/></strong>
                        </p>
                    </t>
                    <t t-if="object.notes">
                        <p><strong>Terms and Conditions:</strong><br/>
                        <span t-field="object.notes"/>
                        </p>
                    </t>
                    <p>
                        Please make the payment by the due date to avoid late fees.
                    </p>
                    <p>
                        For any queries, please contact us at <span t-out="object.company_id.phone or object.company_id.email"/>.
                    </p>
                    <p>Thank you for your business!</p>
                    <br/>
                    Best regards,<br/>
                    <strong><span t-field="object.company_id.name"/></strong><br/>
                    <t t-if="object.property_id.manager_id">
                        <span t-field="object.property_id.manager_id.name"/><br/>
                        Property Manager<br/>
                    </t>
                    <t t-if="object.company_id.phone">
                        Phone: <span t-field="object.company_id.phone"/><br/>
                    </t>
                    <t t-if="object.company_id.email">
                        Email: <span t-field="object.company_id.email"/>
                    </t>
                </p>
            </span>
        </field>
        <field name="report_template_ids" eval="[(4, ref('property_management_lite.action_report_property_invoice'))]"/>
        <field name="auto_delete" eval="True"/>
    </record>

    <!-- Payment Receipt Email Template -->
    <record id="email_template_property_receipt" model="mail.template">
        <field name="name">Property Payment Receipt - Send by Email</field>
        <field name="model_id" ref="model_account_move"/>
        <field name="subject">Payment Receipt ${object.name} - Thank you for your payment</field>
        <field name="email_to">${object.tenant_id.email}</field>
        <field name="email_cc">${object.invoice_id.property_id.manager_id.email or ''}</field>
        <field name="auto_delete" eval="True"/>
        <!-- <field name="report_template_ids" eval="[(4, ref('property_management_lite.action_report_property_receipt'))]"/> -->
        <field name="body_html" type="html">
<div style="margin: 0px; padding: 0px;">
    <p style="margin: 0px; padding: 0px; font-size: 13px;">
        Dear ${object.tenant_id.name},
        <br/><br/>
        Thank you for your payment! We have received your payment of 
        <strong>${object.amount} ${object.currency_id.symbol}</strong> 
        for invoice <strong>${object.invoice_id.name}</strong>.
        <br/><br/>
        <strong>Payment Details:</strong><br/>
        - Receipt Number: ${object.name}<br/>
        - Payment Date: ${object.date}<br/>
        - Amount Paid: ${object.amount} ${object.currency_id.symbol}<br/>
        - Payment Method: ${dict(object._fields['payment_method'].selection).get(object.payment_method)}<br/>
        % if object.reference:
        - Reference: ${object.reference}<br/>
        % endif
        <br/>
        <strong>Property Details:</strong><br/>
        - Property: ${object.invoice_id.property_id.name}<br/>
        - Room: ${object.invoice_id.room_id.name}<br/>
        <br/>
        
        % if object.invoice_id.amount_residual > 0:
        <p style="color: #f0ad4e;">
            <strong>Remaining Balance: ${object.invoice_id.amount_residual} ${object.currency_id.symbol}</strong>
        </p>
        % else:
        <p style="color: #5cb85c;">
            <strong>Invoice Fully Paid - Thank you!</strong>
        </p>
        % endif
        
        <p>
        Please keep this receipt for your records. The attached PDF receipt can be used for any official purposes.
        </p>
        
        <p>
        If you have any questions about this payment or your account, please don't hesitate to contact us.
        </p>
        
        <br/>
        Best regards,<br/>
        ${object.invoice_id.company_id.name}<br/>
        % if object.invoice_id.property_id.manager_id:
        ${object.invoice_id.property_id.manager_id.name}<br/>
        Property Manager<br/>
        % endif
        % if object.invoice_id.company_id.phone:
        Phone: ${object.invoice_id.company_id.phone}<br/>
        % endif
        % if object.invoice_id.company_id.email:
        Email: ${object.invoice_id.company_id.email}
        % endif
    </p>
</div>
        </field>
    </record>

    <!-- Overdue Invoice Reminder Template -->
    <record id="email_template_overdue_invoice" model="mail.template">
        <field name="name">Overdue Invoice Reminder</field>
        <field name="model_id" ref="model_account_move"/>
        <field name="subject">REMINDER: Overdue Invoice ${object.name} - ${object.property_id.name}</field>
        <field name="email_to">${object.tenant_id.email}</field>
        <field name="email_cc">${object.property_id.manager_id.email or ''}</field>
        <field name="auto_delete" eval="True"/>
        <!-- <field name="report_template_ids" eval="[(4, ref('property_management_lite.action_report_property_invoice'))]"/> -->
        <field name="body_html" type="html">
<div style="margin: 0px; padding: 0px;">
    <p style="margin: 0px; padding: 0px; font-size: 13px;">
        Dear ${object.tenant_id.name},
        <br/><br/>
        <strong style="color: #d9534f;">PAYMENT REMINDER</strong>
        <br/><br/>
        This is a friendly reminder that your invoice <strong>${object.name}</strong> 
        for <strong>${object.room_id.name}</strong> at <strong>${object.property_id.name}</strong> 
        is now overdue.
        <br/><br/>
        <strong>Invoice Details:</strong><br/>
        - Invoice Date: ${object.date}<br/>
        - Due Date: <span style="color: #d9534f;"><strong>${object.due_date}</strong></span><br/>
        - Amount Due: <span style="color: #d9534f;"><strong>${object.amount_residual} ${object.currency_id.symbol}</strong></span><br/>
        - Days Overdue: <strong>Several</strong> days<br/>
        <br/>
        
        <p style="background-color: #f2dede; border: 1px solid #ebccd1; padding: 10px; border-radius: 4px;">
        <strong>URGENT:</strong> Please arrange payment immediately to avoid:
        <br/>
        • Late payment fees
        <br/>
        • Additional charges
        <br/>
        • Potential lease termination
        </p>
        
        <p>
        If you have already made this payment, please disregard this notice and contact us with your payment details.
        </p>
        
        <p>
        If you are experiencing financial difficulties, please contact us immediately to discuss payment arrangements.
        </p>
        
        <p>
        <strong>Payment Methods:</strong><br/>
        • Cash payment at property office<br/>
        • Bank transfer<br/>
        • Online payment (if available)<br/>
        • Cheque payment
        </p>
        
        <p>
        For immediate assistance, please contact us at ${object.company_id.phone or object.company_id.email}.
        </p>
        
        <br/>
        Property Management Team,<br/>
        ${object.company_id.name}<br/>
        % if object.property_id.manager_id:
        ${object.property_id.manager_id.name}<br/>
        Property Manager<br/>
        % endif
        % if object.company_id.phone:
        Phone: ${object.company_id.phone}<br/>
        % endif
        % if object.company_id.email:
        Email: ${object.company_id.email}
        % endif
    </p>
</div>
        </field>
    </record>

</odoo>
